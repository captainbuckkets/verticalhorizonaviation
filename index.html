<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Page Turning Animation</title>
    <style>
        @font-face {
            font-family: 'Komu';
            src: url(Komu.otf);
        }

        @font-face {
            font-family: 'Noka';
            src: url(Noka.otf);
        }

        :root {
            --transition-speed: 1200ms;
            --easing: cubic-bezier(0.25, 0.1, 0.25, 1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html,
        body {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            font-family: 'Noka';
            background: #1a1a1a;
            perspective: 1200px;
        }

        h1,
        h2,
        h3,
        h4,
        h5 {
            font-family: 'Komu';
        }

        .book-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .page {
            position: absolute;
            width: 80vw;
            max-width: 800px;
            height: 80vh;
            max-height: 600px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform-origin: left center;
            transform-style: preserve-3d;
            border-top-left-radius: 4px;
            border-bottom-left-radius: 4px;
            border-top-right-radius: 16px;
            border-bottom-right-radius: 16px;
            backface-visibility: visible;
            transition: transform var(--transition-speed) var(--easing), box-shadow var(--transition-speed) var(--easing);
        }


        .page-1 {
            /* background-image: url(white-fine-leather-textured-background.jpg); */
            background-image: url(leather-macro-shot.jpg);
            background-size: contain;
        }

        /* Default state - flat and visible */
        .page.active {
            transform: perspective(1200px) rotateY(0deg) translateZ(0px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
        }

        /* Pages that are "behind" the current page */
        .page.behind {
            transform: perspective(1200px) rotateY(0deg) translateZ(-20px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        /* Page that's currently turning */
        .page.turning {
            transform: perspective(1200px) rotateY(-180deg) translateZ(-15px);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.6);
        }

        /* Pages that have been turned (completely flipped) */
        .page.turned {
            transform: perspective(1200px) rotateY(-180deg) translateZ(-10px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            pointer-events: none;
        }

        /* Dynamic z-index based on page position */
        .page:nth-child(1) {
            z-index: 100;
        }

        .page:nth-child(2) {
            z-index: 99;
        }

        .page:nth-child(3) {
            z-index: 98;
        }

        .page:nth-child(4) {
            z-index: 97;
        }

        .page:nth-child(5) {
            z-index: 96;
        }

        .page:nth-child(6) {
            z-index: 95;
        }

        .page:nth-child(7) {
            z-index: 94;
        }

        .page:nth-child(8) {
            z-index: 93;
        }

        .page:nth-child(9) {
            z-index: 92;
        }

        .page:nth-child(10) {
            z-index: 91;
        }

        /* Disable transitions when we need instant changes */
        .page.no-transition {
            transition: none !important;
        }

        /* Page content styling */
        .page h1 {
            font-size: 3rem;
            margin-bottom: 2rem;
            color: #333;
            text-align: center;
        }

        .page h2 {
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            color: #444;
            text-align: center;
        }

        .page p {
            font-size: 1.2rem;
            line-height: 1.6;
            color: #666;
            text-align: center;
            max-width: 600px;
            margin: 0 2rem;
        }

        .logo {
            font-size: 4rem;
            position: absolute;
            margin-bottom: 1rem;
            top: 50%;
            left: 50%;
            mix-blend-mode: soft-light;
            transform: translate(-50%, -50%);
        }

        section.page.page-1.turned {
            margin-left: 0px;
        }

        .logo img {
            width: 300px;
            height: 300px;
        }

        /* Individual page colors */
        .page:nth-child(1) {
            color: white;
        }

        .page:nth-child(2):has(.behind) .page:nth-child(1) {
            z-index: 0;
        }

        .page:nth-child(1).page.turned {
        }

        .page:nth-child(2) {
            color: white;
        }

        .page:nth-child(2).page.turned {
        }

        .page:nth-child(3) {
            color: #333;
        }

        .page:nth-child(3).page.turned {
        }

        .page:nth-child(4) {
            color: #333;
        }

        .page:nth-child(4).page.turned {
        }

        /* Navigation hint */
        .nav-hint {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #888;
            font-size: 0.9rem;
            text-align: center;
            z-index: 100;
        }
    </style>
</head>

<body>
    <div class="book-container">
        <section class="page active page-1">
            <div class="logo">
                <img src="VHA_05.png" alt="Logo">
            </div>
        </section>

        <section class="page behind">
            <h2>Our Services</h2>
            <p>We offer incredible solutions that transform the way you work and live. Our comprehensive suite of
                services is designed to meet your every need.</p>
        </section>

        <section class="page behind">
            <h2>About Us</h2>
            <p>Founded with a vision to innovate and inspire, we've been at the forefront of creating meaningful
                experiences for our clients around the world.</p>
        </section>

        <section class="page behind">
            <h2>Contact</h2>
            <p>Ready to get started? Reach out to us and let's create something extraordinary together. Your success is
                our mission.</p>
        </section>
    </div>

    <div class="nav-hint">
        Use mouse wheel or swipe to turn pages
    </div>

    <script>
        const pages = [...document.querySelectorAll('.page')];
        let current = 0;
        let isAnimating = false;
        let animationTimeout = null;

        // Initialize page states
        function initializePages() {
            pages.forEach((page, i) => {
                page.classList.remove('active', 'behind', 'turning', 'turned', 'no-transition');

                if (i === 0) {
                    page.classList.add('active');
                } else {
                    page.classList.add('behind');
                }
            });
        }

        function showPage(targetIndex) {
            if (targetIndex === current || targetIndex < 0 || targetIndex >= pages.length) {
                return;
            }

            // Clear any existing animation timeout to allow interruption
            if (animationTimeout) {
                clearTimeout(animationTimeout);
                animationTimeout = null;
            }

            // If we're currently animating, immediately finish the current animation
            if (isAnimating) {
                finishCurrentAnimation();
            }

            isAnimating = true;
            const direction = targetIndex > current ? 'forward' : 'backward';

            if (direction === 'forward') {
                turnPageForward(targetIndex);
            } else {
                turnPageBackward(targetIndex);
            }
        }

        function finishCurrentAnimation() {
            // Remove all transition classes and set final states
            pages.forEach((page, i) => {
                page.classList.remove('turning', 'no-transition');
                page.classList.remove('active', 'behind', 'turned');

                if (i === current) {
                    page.classList.add('active');
                } else if (i < current) {
                    page.classList.add('turned');
                } else {
                    page.classList.add('behind');
                }
            });
            isAnimating = false;
        }

        function turnPageForward(targetIndex) {
            const currentPage = pages[current];
            const nextPage = pages[targetIndex];

            // FIRST: Make sure the next page is ready underneath (no animation)
            nextPage.classList.add('no-transition');
            nextPage.classList.remove('behind');
            nextPage.classList.add('active');

            // Force reflow to apply no-transition
            void nextPage.offsetWidth;
            nextPage.classList.remove('no-transition');

            // THEN: Start the page turn animation on current page
            currentPage.classList.remove('active');
            currentPage.classList.add('turning');

            // When turn animation completes
            animationTimeout = setTimeout(() => {
                // Complete the turn
                currentPage.classList.remove('turning');
                currentPage.classList.add('turned');

                // Update all page states
                updatePageStates(targetIndex);

                current = targetIndex;
                isAnimating = false;
                animationTimeout = null;
            }, 600); // Half the transition time for smooth effect
        }

        function turnPageBackward(targetIndex) {
            const currentPage = pages[current];
            const prevPage = pages[targetIndex];

            // FIRST: Prepare the previous page underneath in the turned state (no animation)
            prevPage.classList.add('no-transition');
            prevPage.classList.remove('behind', 'active');
            prevPage.classList.add('turned');

            // Force reflow
            void prevPage.offsetWidth;
            prevPage.classList.remove('no-transition');

            // THEN: Move current page to behind
            currentPage.classList.remove('active');
            currentPage.classList.add('behind');

            // Now animate the previous page "unturning" from turned back to active
            prevPage.classList.remove('turned');
            prevPage.classList.add('turning');

            // Small delay to ensure the turning class is applied
            requestAnimationFrame(() => {
                prevPage.classList.remove('turning');
                prevPage.classList.add('active');
            });

            animationTimeout = setTimeout(() => {
                // Update all page states
                updatePageStates(targetIndex);

                current = targetIndex;
                isAnimating = false;
                animationTimeout = null;
            }, 600);
        }

        function updatePageStates(activeIndex) {
            pages.forEach((page, i) => {
                page.classList.remove('active', 'behind', 'turning', 'turned');

                if (i === activeIndex) {
                    page.classList.add('active');
                } else if (i < activeIndex) {
                    page.classList.add('turned');
                } else {
                    page.classList.add('behind');
                }
            });
        }

        // Mouse wheel navigation
        let wheelTimeout;
        window.addEventListener('wheel', (e) => {
            e.preventDefault();

            clearTimeout(wheelTimeout);
            wheelTimeout = setTimeout(() => {
                if (e.deltaY > 0 && current < pages.length - 1) {
                    showPage(current + 1);
                } else if (e.deltaY < 0 && current > 0) {
                    showPage(current - 1);
                }
            }, 10); // Reduced timeout for more responsive interruption
        }, { passive: false });

        // Touch navigation
        let startY = null;
        let startX = null;

        window.addEventListener('touchstart', (e) => {
            startY = e.touches[0].clientY;
            startX = e.touches[0].clientX;
        });

        window.addEventListener('touchend', (e) => {
            if (startY === null || startX === null) return;

            const deltaY = startY - e.changedTouches[0].clientY;
            const deltaX = startX - e.changedTouches[0].clientX;

            // Prioritize vertical swipes for page turning
            if (Math.abs(deltaY) > Math.abs(deltaX)) {
                if (deltaY > 50 && current < pages.length - 1) {
                    showPage(current + 1);
                } else if (deltaY < -50 && current > 0) {
                    showPage(current - 1);
                }
            }

            startY = null;
            startX = null;
        });

        // Keyboard navigation
        window.addEventListener('keydown', (e) => {
            switch (e.key) {
                case 'ArrowRight':
                case 'ArrowDown':
                case ' ':
                    e.preventDefault();
                    if (current < pages.length - 1) showPage(current + 1);
                    break;
                case 'ArrowLeft':
                case 'ArrowUp':
                    e.preventDefault();
                    if (current > 0) showPage(current - 1);
                    break;
            }
        });

        // Initialize
        initializePages();
    </script>
</body>

</html>